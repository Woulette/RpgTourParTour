<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>RPG Phaser</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: #000000;
    }
    canvas {
      display: block;
      width: 100%;
      height: 100%;
    }
  </style>
  <link rel="stylesheet" href="assets/css/hud.css" />
  <link rel="stylesheet" href="assets/css/hudPanels.css" />
  <link rel="stylesheet" href="assets/css/hudInterface.css" />
  <link rel="stylesheet" href="assets/css/stats.css" />
  <link rel="stylesheet" href="assets/css/metiers.css" />
  <link rel="stylesheet" href="assets/css/combat.css" />
  <link rel="stylesheet" href="assets/css/combatResult.css" />
  <link rel="stylesheet" href="assets/css/combatInspector.css" />
  <link rel="stylesheet" href="assets/css/spellBook.css" />
  <link rel="stylesheet" href="assets/css/inventory.css" />
  <link rel="stylesheet" href="assets/css/map.css" />
  <link rel="stylesheet" href="assets/css/npcDialog.css" />
  <link rel="stylesheet" href="assets/css/quests.css" />
  <link rel="stylesheet" href="assets/css/questTracker.css" />
  <link rel="stylesheet" href="assets/css/chat.css" />
  <link rel="stylesheet" href="assets/css/menu.css" />
</head>
<body class="menu-open">
  <!-- Menus (création / sélection personnage) -->
  <div id="menu-overlay" class="menu-overlay" aria-label="Menu principal">
    <div class="menu-panel">
      <header class="menu-header">
        <h1 class="menu-title">Andémia</h1>
      </header>

      <!-- Sélection personnage -->
      <section id="menu-screen-select" class="menu-screen" aria-label="Sélection du personnage">
        <h2 class="menu-screen-title">Choisir un personnage</h2>
        <div id="character-list" class="character-list"></div>
        <div class="menu-actions">
          <button id="btn-go-create" class="menu-btn menu-btn-secondary" type="button">
            Créer un personnage
          </button>
          <button id="btn-play" class="menu-btn menu-btn-primary" type="button" disabled>
            Jouer
          </button>
        </div>
      </section>

      <!-- Création personnage -->
      <section id="menu-screen-create" class="menu-screen" aria-label="Création du personnage" hidden>
        <h2 class="menu-screen-title">Créer un personnage</h2>
        <form id="character-create-form" class="create-form" autocomplete="off">
          <label class="create-label">
            Nom
            <input id="character-name" class="create-input" type="text" maxlength="16" placeholder="Ex: Ntmav" />
          </label>

          <div class="class-picker">
            <div class="class-picker-title">Classe</div>
            <div id="class-list" class="class-list"></div>
          </div>

          <div class="menu-actions">
            <button id="btn-back-select" class="menu-btn menu-btn-secondary" type="button">
              Retour
            </button>
            <button id="btn-create" class="menu-btn menu-btn-primary" type="submit" disabled>
              Créer
            </button>
          </div>
        </form>
      </section>
    </div>
  </div>

  <!-- Bouton en jeu : retour menu -->
  <button id="ui-return-menu" class="ui-return-menu" type="button" aria-label="Retour au menu" title="Retour au menu">
    MENU
  </button>

  <div id="quest-tracker" class="quest-tracker" aria-label="Suivi des quetes">
    <button
      id="quest-tracker-toggle"
      class="quest-tracker-toggle"
      type="button"
      aria-expanded="false"
      aria-controls="quest-tracker-list"
      title="Afficher / masquer les quetes suivies"
    >
      <span class="quest-tracker-toggle-icon">›</span>
    </button>
    <div class="quest-tracker-inner">
      <div class="quest-tracker-header">
        <span class="quest-tracker-title">Quetes</span>
      </div>
      <div id="quest-tracker-list" class="quest-tracker-list"></div>
    </div>
  </div>

  <div id="combat-inspector" class="combat-inspector compact" aria-label="Détails combat">
    <div class="combat-inspector-header">
      <div id="combat-inspector-title" class="combat-inspector-title">-</div>
      <div class="combat-inspector-actions">
        <button id="combat-inspector-close" class="combat-inspector-btn" type="button" title="Fermer">×</button>
      </div>
    </div>
    <div id="combat-inspector-body" class="combat-inspector-body"></div>
  </div>

  <!-- HUD HTML en overlay par-dessus le canvas Phaser -->
  <div id="hud-root">
    <!-- Barre HUD en bas de l'écran -->
    <div id="hud-bar">
      <!-- Chat (zone fixe, style MMO) -->
      <section id="hud-chat" class="hud-chat" aria-label="Chat">
        <header class="hud-chat-header">
          <div id="hud-chat-tabs" class="hud-chat-tabs" role="tablist" aria-label="Canaux de chat"></div>
        </header>
        <div id="chat-messages" class="hud-chat-messages" aria-live="polite"></div>
        <form id="chat-form" class="hud-chat-form" autocomplete="off">
          <input
            id="chat-input"
            class="hud-chat-input"
            type="text"
            maxlength="200"
            placeholder="Écrire..."
            aria-label="Saisir un message"
          />
        </form>
      </section>
      <button class="hud-pill" id="hud-quests-button" aria-label="Ouvrir les quêtes">
        QUETES
      </button>
      <button class="hud-pill" id="hud-metiers-button" aria-label="Ouvrir les métiers">
        MÉTIERS
      </button>

      <!-- Mini-carte au centre du HUD -->
      <div id="hud-minimap" aria-label="Mini-carte de la zone"></div>

      <!-- Dock HUD unifié (menu + barre sorts/objets) -->
      <section id="hud-dock" class="hud-dock" aria-label="Menu et actions">
        <div id="hud-dock-menu" class="hud-dock-menu" aria-label="Raccourcis HUD">
          <button class="hud-pill" id="hud-map-button" aria-label="Ouvrir la carte du monde">
            CARTE
          </button>
          <button class="hud-pill" id="hud-inventory-button" aria-label="Ouvrir l'inventaire">
            INV
          </button>
          <button class="hud-pill" id="hud-spells-button" aria-label="Ouvrir les sorts">
            SORTS
          </button>
          <button class="hud-pill" id="hud-stats-button" aria-label="Ouvrir les statistiques">
            STATS
          </button>
        </div>

      <!-- Conteneur barre de sorts + petits slots Sorts/Obj. -->
      <div id="hud-spell-container">
        <!-- Barre de sorts du HUD (toujours visible, sorts utilisables surtout en combat) -->
        <div id="hud-spell-bar" aria-label="Barre de sorts">
          <!-- Ligne 1 -->
          <div class="hud-spell-slot" data-slot="1">
            <span class="hud-spell-name"></span>
          </div>
          <div class="hud-spell-slot empty" data-slot="2">
            <span class="hud-spell-name"></span>
          </div>
          <div class="hud-spell-slot empty" data-slot="3">
            <span class="hud-spell-name"></span>
          </div>
          <div class="hud-spell-slot empty" data-slot="4">
            <span class="hud-spell-name"></span>
          </div>
          <div class="hud-spell-slot empty" data-slot="5">
            <span class="hud-spell-name"></span>
          </div>
          <!-- Ligne 2 -->
          <div class="hud-spell-slot empty" data-slot="6">
            <span class="hud-spell-name"></span>
          </div>
          <div class="hud-spell-slot empty" data-slot="7">
            <span class="hud-spell-name"></span>
          </div>
          <div class="hud-spell-slot empty" data-slot="8">
            <span class="hud-spell-name"></span>
          </div>
          <div class="hud-spell-slot empty" data-slot="9">
            <span class="hud-spell-name"></span>
          </div>
          <div class="hud-spell-slot empty" data-slot="10">
            <span class="hud-spell-name"></span>
          </div>
          <div class="hud-spell-slot empty" data-slot="11">
            <span class="hud-spell-name"></span>
          </div>
          <div class="hud-spell-slot empty" data-slot="12">
            <span class="hud-spell-name"></span>
          </div>
          <div class="hud-spell-slot empty" data-slot="13">
            <span class="hud-spell-name"></span>
          </div>
          <div class="hud-spell-slot empty" data-slot="14">
            <span class="hud-spell-name"></span>
          </div>
          <div class="hud-spell-slot empty" data-slot="15">
            <span class="hud-spell-name"></span>
          </div>
          <div class="hud-spell-slot empty" data-slot="16">
            <span class="hud-spell-name"></span>
          </div>
          <div class="hud-spell-slot empty" data-slot="17">
            <span class="hud-spell-name"></span>
          </div>
          <div class="hud-spell-slot empty" data-slot="18">
            <span class="hud-spell-name"></span>
          </div>
        </div>

        <!-- Petits slots verticaux Sorts / Objets (purement visuel pour l'instant) -->
        <div id="hud-spell-toggle">
          <div class="hud-spell-toggle-slot hud-spell-toggle-spells">Sorts</div>
          <div class="hud-spell-toggle-slot hud-spell-toggle-items">Obj.</div>
        </div>
      </div>

      <!-- Fiche cible (combat uniquement) : remplace visuellement la barre de sorts au survol -->
      <div id="combat-target-panel" aria-label="Fiche cible (combat)">
        <div class="combat-target-header">
          <span id="combat-target-name">-</span>
        </div>
        <div class="combat-target-hp">
          <div class="combat-target-hp-bar" aria-hidden="true">
            <div id="combat-target-hp-fill" class="combat-target-hp-fill"></div>
          </div>
          <div id="combat-target-hp-text" class="combat-target-hp-text">PV : -/-</div>
        </div>
        <div class="combat-target-stats">
          <div class="combat-target-stat">
            <span class="combat-target-stat-label">PA</span>
            <span id="combat-target-pa" class="combat-target-stat-value">-</span>
          </div>
          <div class="combat-target-stat">
            <span class="combat-target-stat-label">PM</span>
            <span id="combat-target-pm" class="combat-target-stat-value">-</span>
          </div>
        </div>
      </div>
      </section>

      <!-- PA / PM toujours visibles dans le HUD bas -->
      <div id="hud-ap-mp">
        <span class="hud-ap-label">PA :</span>
        <span id="hud-ap-value">6</span>
        <span class="hud-mp-label">PM :</span>
        <span id="hud-mp-value">3</span>
        <span class="hud-hp-label">PV :</span>
        <span id="hud-hp-value">50</span>
      </div>


    </div>

    <!-- Fenêtre d'inventaire -->
    <aside id="hud-inventory-panel" aria-label="Inventaire du personnage">
      <header class="inventory-header">
        <h2 class="inventory-title">Inventaire</h2>
        <div class="inventory-filters">
          <button class="inventory-filter-btn inventory-filter-active" data-filter="all">Tout</button>
          <button class="inventory-filter-btn" data-filter="equipement">Equip.</button>
          <button class="inventory-filter-btn" data-filter="consommable">Consom.</button>
          <button class="inventory-filter-btn" data-filter="ressource">Ress.</button>
          <button class="inventory-filter-btn" data-filter="quete">Quête</button>
        </div>
        <div class="inventory-gold">
          Or : <span id="inventory-gold-value">0</span>
        </div>
      </header>

      <div class="inventory-body">
        <div class="inventory-left">
          <div class="inventory-equip">
            <div class="equip-character"></div>
            <div class="equip-grid">
              <div class="equip-slot" data-equip="head"></div>
              <div class="equip-slot" data-equip="cape"></div>
              <div class="equip-slot" data-equip="amulet"></div>
              <div class="equip-slot" data-equip="weapon"></div>
              <div class="equip-slot" data-equip="ring1"></div>
              <div class="equip-slot" data-equip="ring2"></div>
              <div class="equip-slot" data-equip="belt"></div>
              <div class="equip-slot" data-equip="boots"></div>
            </div>
          </div>

          <div class="inventory-detail">
            <h3 id="inventory-item-name">-</h3>
            <div id="inventory-item-type"></div>
            <div id="inventory-item-bonus"></div>
            <div id="inventory-item-desc"></div>
          </div>
        </div>

        <div class="inventory-right">
          <div class="inventory-grid" id="inventory-grid">
            <!-- Slots créés dynamiquement -->
          </div>
        </div>
      </div>
    </aside>

    <!-- Fenêtre de statistiques (simple, responsive) -->
    <aside id="hud-stats-panel" aria-label="Fenêtre de statistiques du personnage">
      <header class="stats-header">
        <h2 class="stats-title">Statistiques</h2>
        <div class="stats-player-name">Nom : <span id="stat-player-name">---</span></div>
        <div class="stats-level-line">
          Niveau : <span id="stat-level">1</span>
          &nbsp;-&nbsp;
          XP : <span id="stat-xp">0</span>
          / <span id="stat-xp-next">50</span>
        </div>
        <div class="stats-hp-init-line">
          PV max : <span id="stat-hpMax">50</span>
          &nbsp;-&nbsp;
          Initiative : <span id="stat-initiative">0</span>
        </div>
      </header>

      <section class="stats-section">
        <h3 class="stats-section-title">Actions</h3>
        <ul class="stats-list">
          <li><span class="label">PA</span><span class="value" id="stat-pa">6</span></li>
          <li><span class="label">PM</span><span class="value" id="stat-pm">3</span></li>
        </ul>
      </section>

      <section class="stats-section">
        <h3 class="stats-section-title">Caractéristiques</h3>
        <ul class="stats-list">
          <li class="stat-line" data-stat="force">
            <span class="label">Force</span>
            <div class="stat-controls">
              <button type="button" class="stat-btn stat-btn-minus" data-stat="force">-</button>
              <input type="number" id="stat-force-input" class="stat-input" min="0" step="1" />
              <button type="button" class="stat-btn stat-btn-plus" data-stat="force">+</button>
            </div>
          </li>
          <li class="stat-line" data-stat="intelligence">
            <span class="label">Intelligence</span>
            <div class="stat-controls">
              <button type="button" class="stat-btn stat-btn-minus" data-stat="intelligence">-</button>
              <input type="number" id="stat-intelligence-input" class="stat-input" min="0" step="1" />
              <button type="button" class="stat-btn stat-btn-plus" data-stat="intelligence">+</button>
            </div>
          </li>
          <li class="stat-line" data-stat="agilite">
            <span class="label">Agilité</span>
            <div class="stat-controls">
              <button type="button" class="stat-btn stat-btn-minus" data-stat="agilite">-</button>
              <input type="number" id="stat-agilite-input" class="stat-input" min="0" step="1" />
              <button type="button" class="stat-btn stat-btn-plus" data-stat="agilite">+</button>
            </div>
          </li>
          <li class="stat-line" data-stat="chance">
            <span class="label">Chance</span>
            <div class="stat-controls">
              <button type="button" class="stat-btn stat-btn-minus" data-stat="chance">-</button>
              <input type="number" id="stat-chance-input" class="stat-input" min="0" step="1" />
              <button type="button" class="stat-btn stat-btn-plus" data-stat="chance">+</button>
            </div>
          </li>
          <li class="stat-line" data-stat="vitalite">
            <span class="label">Vitalité</span>
            <div class="stat-controls">
              <button type="button" class="stat-btn stat-btn-minus" data-stat="vitalite">-</button>
              <input type="number" id="stat-vitalite-input" class="stat-input" min="0" step="1" />
              <button type="button" class="stat-btn stat-btn-plus" data-stat="vitalite">+</button>
            </div>
          </li>
          <li class="stat-line" data-stat="sagesse">
            <span class="label">Sagesse</span>
            <div class="stat-controls">
              <button type="button" class="stat-btn stat-btn-minus" data-stat="sagesse">-</button>
              <input type="number" id="stat-sagesse-input" class="stat-input" min="0" step="1" />
              <button type="button" class="stat-btn stat-btn-plus" data-stat="sagesse">+</button>
            </div>
          </li>
        </ul>
      </section>

      <section class="stats-section stats-points-section">
        <div class="stats-points-line">
          Points à répartir :
          <span id="stat-points-libres">0</span>
        </div>
      </section>
    </aside>

    <!-- Fenêtre des métiers -->
    <aside id="hud-metiers-panel" aria-label="Fenêtre des métiers du personnage">
      <header class="metiers-header">
        <h2 class="metiers-title">Métiers</h2>
      </header>

      <section class="metiers-section">
        <div class="metier-line">
          <span class="metier-name">Bûcheron</span>
          <span class="metier-level">
            Niv. <span id="metier-bucheron-level">1</span>
          </span>
        </div>
        <div class="metier-xp-line">
          XP : <span id="metier-bucheron-xp">0</span>
          / <span id="metier-bucheron-xp-next">100</span>
        </div>
      </section>
    </aside>

    <!-- Fenêtre des sorts de la classe -->
    <aside id="hud-spells-panel" aria-label="Fenêtre des sorts de la classe">
      <header class="spells-header">
        <h2 class="spells-title">Sorts</h2>
        <div class="spells-class-name">
          Classe : <span id="spells-class-name">---</span>
        </div>
        <div class="spells-tier-bar">
          <span class="spells-tier-label" data-tier="1">Tier 1</span>
          <span class="spells-tier-label" data-tier="2">Tier 2</span>
          <span class="spells-tier-label" data-tier="3">Tier 3</span>
        </div>
      </header>

      <section class="spells-section">
        <ul id="hud-spells-list" class="spells-list">
          <!-- Rempli dynamiquement -->
        </ul>
        <div id="hud-spell-detail" class="spell-detail">
          <!-- Detail du sort selectionne -->
        </div>
      </section>
    </aside>

    <!-- Fenêtre de carte du monde -->
    <aside id="hud-map-panel" aria-label="Carte du monde">
      <header class="map-header">
        <h2 class="map-title">Carte</h2>
      </header>
      <section class="map-body">
        <div class="map-main">
          <div class="map-inner"></div>
        </div>
      </section>
    </aside>

    <!-- Fenêtre de dialogue PNJ -->
    <aside
      id="npc-dialog-panel"
      class="npc-dialog-panel"
      aria-label="Dialogue avec un PNJ"
      aria-hidden="true"
    >
      <header class="npc-dialog-header">
        <h2 id="npc-dialog-name" class="npc-dialog-name">PNJ</h2>
        <button
          id="npc-dialog-close"
          class="npc-dialog-close-btn"
          type="button"
          aria-label="Fermer le dialogue"
        >
          ×
        </button>
      </header>
      <section class="npc-dialog-body">
        <div class="npc-dialog-block npc-dialog-npc-block">
          <div class="npc-dialog-speaker-line">
            <span
              id="npc-dialog-speaker-npc"
              class="npc-dialog-speaker npc-dialog-speaker-npc"
              >PNJ</span
            >
          </div>
          <div id="npc-dialog-text" class="npc-dialog-text">
            Bonjour.
          </div>
        </div>

        <div class="npc-dialog-block npc-dialog-player-block">
          <div class="npc-dialog-speaker-line">
            <span class="npc-dialog-speaker npc-dialog-speaker-player"
              >Vous</span
            >
          </div>
          <div class="npc-dialog-choices">
            <button
              id="npc-dialog-choice-1"
              type="button"
              class="npc-dialog-choice"
            >
              Bonjour.
            </button>
            <span id="npc-dialog-quest-badge" class="npc-dialog-quest-badge" aria-hidden="true">!</span>
          </div>
        </div>
      </section>
    </aside>

    <!-- Fenetre des quetes -->
    <aside id="hud-quests-panel" aria-label="Fenetre des quetes du personnage">
      <header class="quests-header">
        <h2 class="quests-title">Quetes</h2>
      </header>
      <section class="quests-body">
        <div class="quests-columns">
          <div class="quests-column">
            <h3 class="quests-column-title">Disponibles</h3>
            <ul id="quests-list-available" class="quests-list"></ul>
          </div>
          <div class="quests-column">
            <h3 class="quests-column-title">En cours</h3>
            <ul id="quests-list-active" class="quests-list"></ul>
          </div>
          <div class="quests-column">
            <h3 class="quests-column-title">Terminees</h3>
            <ul id="quests-list-completed" class="quests-list"></ul>
          </div>
        </div>
        <div class="quests-detail">
          <h3 id="quest-detail-title" class="quest-detail-title"></h3>
          <p id="quest-detail-desc" class="quest-detail-desc"></p>
          <p id="quest-detail-progress" class="quest-detail-progress"></p>
          <p id="quest-detail-rewards" class="quest-detail-rewards"></p>
        </div>
      </section>
    </aside>
  </div>

  <!-- UI de combat (bouton passer le tour, indicateur) -->
  <div id="combat-ui-root">
    <div id="combat-turn-order" aria-label="Ordre des tours">
      <div id="combat-turn-order-list" role="list"></div>
      <div id="combat-round-indicator">
        Tour : <span id="combat-round-value">1</span>
      </div>
    </div>
    <div id="combat-turn-indicator">
      Tour : <span id="combat-turn-label">Joueur</span>
    </div>
    <button id="combat-end-turn-button" type="button">
      FIN DU TOUR
    </button>
    <button id="combat-ready-button" type="button">
      PRET
    </button>
  </div>

  <!-- Popup de fin de combat -->
  <div id="combat-result-overlay" class="combat-result-hidden">
    <div class="combat-result-panel">
      <h2 id="combat-result-title" class="combat-result-title">Fin du combat</h2>
      <div class="combat-result-body">
        <div class="combat-result-section">
          <h3>Joueur</h3>
          <p>Niveau : <span id="combat-result-player-level">1</span></p>
          <p>XP gagnée : <span id="combat-result-xp-gain">0</span></p>
          <p>XP totale : <span id="combat-result-xp-total">0</span></p>
          <p>XP prochaine : <span id="combat-result-xp-next">0</span></p>
        </div>
        <div class="combat-result-section">
          <h3>Monstre</h3>
          <p>Id : <span id="combat-result-monster-name">-</span></p>
          <p>PV restants : <span id="combat-result-monster-hp">0</span></p>
        </div>
        <div class="combat-result-section">
          <h3>Combat</h3>
          <p>Durée : <span id="combat-result-duration">0s</span></p>
          <p>Or : <span id="combat-result-gold">0</span></p>
        </div>
        <div class="combat-result-section">
          <h3>Butin</h3>
          <div id="combat-result-loot" class="combat-result-loot-list"></div>
        </div>
      </div>
      <div class="combat-result-actions">
        <button id="combat-result-continue-button" type="button">
          Continuer
        </button>
      </div>
    </div>
  </div>
<script src="https://cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.min.js"></script>
  <script type="module" src="src/main.js"></script>
</body>
</html>
